# Make

## Format

A make file consist of 3 main parameters(rules):

1. Target - the name of the file that needs to be generated by a program (executable or object files)
2. Prerequistites - a file that is used as a input to create the target.
3. Recipe - the action the `make` carries out. This can be more than one command either on the same line or on its own. 

> [!NOTE] 
> The recipe needs a `\t` `tab` at the beginning of each recipe

Example:
```
target: prerequistites ...
	recipe <-- Notice this has a tab
```

When running `make` it will build the very first target listed in the make file by convention. 

```
Makefile
# This is a make file

all: program main

program: program.o
	gcc program -o program

main: main.o
	gcc main.o -o main	

main.o: main.c
	gcc -c main.c

program.o: program.c
	gcc -c program.c

$ make
gcc -c program.c
gcc -c main.c
gcc main.o -o main
gcc program.o -o program

$ ls 
main.o program.o program main
```

But lets just say you just want to make just program, instead of typing `make` do:

```
$ make program
$ ls
program program.o
```

There can be a `.Phony` target which carries out an action that does not produce a file.

### Special Variables

There are seven core automatic variables:

1. `$@`: THe filename representing the target
2. `$%`: The filename element of an archive member specifications
3. `$<`: The file name of the first prerequistite
4. `$?`: The names of all prerequistites that are newer than the target, separated by spaces
5. `$^`: The filenames of all the prerequistites, seperated by spaces. This list has duplicated filenames removed
6. `$+`: The filenames of all the prerequistites, seperated by spaces. This list has duplicates
7. `$*`: The stem of the target filename. A stem is typically a filename without its suffix.

Example:
```
server: main.o server.o net_utility.o
	gcc -o $@ $^ $<
```
- `$@` = server (target)
- `$^` = main.o server.o net_utility.o (all prerequistites)
- `$<` = main.o (first prerequistite)
